<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>gin中使用swagger | bing随遇而安</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="
安装
使用如下命令安装swag命令
➜  go go install github.com/swaggo/swag/cmd/swag@latest
go: downloading github.com/ghodss/yaml v1.0.0
go: downloading github.com/urfave/cli/v2 v2.3.0
go: downloading ...">
    
    <link rel="preload" href="/assets/css/0.styles.29350883.css" as="style"><link rel="preload" href="/assets/js/app.99f1e4ad.js" as="script"><link rel="preload" href="/assets/js/6.38d57c41.js" as="script"><link rel="preload" href="/assets/js/3.122d5fd9.js" as="script"><link rel="preload" href="/assets/js/28.7ec74a54.js" as="script"><link rel="prefetch" href="/assets/js/10.228be548.js"><link rel="prefetch" href="/assets/js/11.2657ec05.js"><link rel="prefetch" href="/assets/js/12.d23da198.js"><link rel="prefetch" href="/assets/js/13.cb896045.js"><link rel="prefetch" href="/assets/js/14.f7014cd5.js"><link rel="prefetch" href="/assets/js/15.b4fdfaf9.js"><link rel="prefetch" href="/assets/js/16.1ed35f77.js"><link rel="prefetch" href="/assets/js/17.df35c078.js"><link rel="prefetch" href="/assets/js/18.22084766.js"><link rel="prefetch" href="/assets/js/19.c32295b2.js"><link rel="prefetch" href="/assets/js/20.9265417b.js"><link rel="prefetch" href="/assets/js/21.b666c22f.js"><link rel="prefetch" href="/assets/js/22.1dc4fe77.js"><link rel="prefetch" href="/assets/js/23.050dc1d5.js"><link rel="prefetch" href="/assets/js/24.e780ac86.js"><link rel="prefetch" href="/assets/js/25.361820b5.js"><link rel="prefetch" href="/assets/js/26.1ed44252.js"><link rel="prefetch" href="/assets/js/27.4172c86c.js"><link rel="prefetch" href="/assets/js/29.765137d8.js"><link rel="prefetch" href="/assets/js/30.1dfae280.js"><link rel="prefetch" href="/assets/js/31.619710f3.js"><link rel="prefetch" href="/assets/js/32.b2ba2b4e.js"><link rel="prefetch" href="/assets/js/33.8f979719.js"><link rel="prefetch" href="/assets/js/34.77ca4544.js"><link rel="prefetch" href="/assets/js/35.8b63bb58.js"><link rel="prefetch" href="/assets/js/36.a00bdb79.js"><link rel="prefetch" href="/assets/js/37.31208d43.js"><link rel="prefetch" href="/assets/js/38.e4061449.js"><link rel="prefetch" href="/assets/js/39.d954ad62.js"><link rel="prefetch" href="/assets/js/4.380f1af6.js"><link rel="prefetch" href="/assets/js/40.9f8657fc.js"><link rel="prefetch" href="/assets/js/41.4be424ee.js"><link rel="prefetch" href="/assets/js/42.8b8f18a9.js"><link rel="prefetch" href="/assets/js/43.d18752d5.js"><link rel="prefetch" href="/assets/js/44.6cfba6ea.js"><link rel="prefetch" href="/assets/js/45.9fc18aa9.js"><link rel="prefetch" href="/assets/js/46.393ef73d.js"><link rel="prefetch" href="/assets/js/47.0f2e95bf.js"><link rel="prefetch" href="/assets/js/48.9d37dc07.js"><link rel="prefetch" href="/assets/js/49.ec859e26.js"><link rel="prefetch" href="/assets/js/5.084c9b71.js"><link rel="prefetch" href="/assets/js/50.bc952277.js"><link rel="prefetch" href="/assets/js/51.edc8ea0b.js"><link rel="prefetch" href="/assets/js/52.5c8a8785.js"><link rel="prefetch" href="/assets/js/53.1c990a56.js"><link rel="prefetch" href="/assets/js/54.576aac00.js"><link rel="prefetch" href="/assets/js/55.522b9009.js"><link rel="prefetch" href="/assets/js/56.108df189.js"><link rel="prefetch" href="/assets/js/57.1c7288b2.js"><link rel="prefetch" href="/assets/js/58.54c40e36.js"><link rel="prefetch" href="/assets/js/59.5d8fb44a.js"><link rel="prefetch" href="/assets/js/60.f82dec03.js"><link rel="prefetch" href="/assets/js/61.e99100ac.js"><link rel="prefetch" href="/assets/js/62.343dfcb5.js"><link rel="prefetch" href="/assets/js/63.739ae802.js"><link rel="prefetch" href="/assets/js/64.2f0a2620.js"><link rel="prefetch" href="/assets/js/65.9324b47f.js"><link rel="prefetch" href="/assets/js/66.149f4502.js"><link rel="prefetch" href="/assets/js/67.1dc32535.js"><link rel="prefetch" href="/assets/js/68.61b42ea3.js"><link rel="prefetch" href="/assets/js/69.a5fcafb4.js"><link rel="prefetch" href="/assets/js/7.358fd391.js"><link rel="prefetch" href="/assets/js/70.9490ba98.js"><link rel="prefetch" href="/assets/js/71.a03aeaa5.js"><link rel="prefetch" href="/assets/js/72.b6d5a4d8.js"><link rel="prefetch" href="/assets/js/73.fe365994.js"><link rel="prefetch" href="/assets/js/74.300995df.js"><link rel="prefetch" href="/assets/js/75.b8262569.js"><link rel="prefetch" href="/assets/js/76.82671849.js"><link rel="prefetch" href="/assets/js/77.6f7e88ff.js"><link rel="prefetch" href="/assets/js/8.d351dd84.js"><link rel="prefetch" href="/assets/js/9.0a60c476.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.ac365ac7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.29350883.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">bing随遇而安 </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">首页</a></li><li class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></li><li class="nav-item"><a href="/data-structure/" class="nav-link">数据结构</a></li><li class="nav-item"><a href="/interview/" class="nav-link">面试</a></li><li class="nav-item"><a href="/tag/" class="nav-link">标签</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">bing随遇而安 </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">首页</a></li><li class="mobile-nav-item"><a href="/algorithm/" class="nav-link">算法</a></li><li class="mobile-nav-item"><a href="/data-structure/" class="nav-link">数据结构</a></li><li class="mobile-nav-item"><a href="/interview/" class="nav-link">面试</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">标签</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">BING随遇而安</span> <span itemprop="address">   in Shanghai</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2022-11-03T00:00:00.000Z">
      2022-11-03
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/golang" data-v-42ccfcd5><span data-v-42ccfcd5>golang</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/gin" data-v-42ccfcd5><span data-v-42ccfcd5>gin</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/swagger" data-v-42ccfcd5><span data-v-42ccfcd5>swagger</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h1 id="gin中使用swagger"><a href="#gin中使用swagger" class="header-anchor">#</a> gin中使用swagger</h1> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">## 使用如下命令安装swag命令</span>
➜  go go <span class="token function">install</span> github.com/swaggo/swag/cmd/swag@latest
go: downloading github.com/ghodss/yaml v1.0.0
go: downloading github.com/urfave/cli/v2 v2.3.0
go: downloading golang.org/x/net v0.0.0-20220722155237-a158d28d115b
go: downloading golang.org/x/text v0.3.7
go: downloading golang.org/x/sys v0.0.0-20220722155257-8c9f86f7a55f
go: downloading github.com/cpuguy83/go-md2man/v2 v2.0.0-20190314233015-f79a8a8ca69d
go: downloading github.com/russross/blackfriday/v2 v2.0.1
go: downloading github.com/shurcooL/sanitized_anchor_name v1.0.0
➜  go

<span class="token comment">## 查看是否安装成功</span>
➜  go swag <span class="token parameter variable">-v</span>     
swag version v1.8.7

</code></pre></div><h2 id="注释"><a href="#注释" class="header-anchor">#</a> 注释</h2> <p>给代码添加注释，注释主要分为两类，一类是全局注释信息，一般放在入口函数main上。另一类是api注释信息，放在每个每个api处理函数上面</p> <h4 id="全局注释"><a href="#全局注释" class="header-anchor">#</a> 全局注释</h4> <h5 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h5> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// @Title       gin framework layout</span>
<span class="token comment">// @Version     0.0.1</span>
<span class="token comment">// @Description gin framework layout</span>

<span class="token comment">// @host localhost:8888</span>

<span class="token comment">// @securityDefinitions.apikey Authorization</span>
<span class="token comment">// @in                         header</span>
<span class="token comment">// @name                       Authorization</span>
<span class="token comment">// @description                api request authorization</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	core<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">RegisterRoutersFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="说明"><a href="#说明" class="header-anchor">#</a> 说明</h5> <table><thead><tr><th>注释</th> <th>说明</th></tr></thead> <tbody><tr><td>Title</td> <td>应用标题</td></tr> <tr><td>Version</td> <td>应用版本</td></tr> <tr><td>Description</td> <td>应用描述</td></tr> <tr><td>TermsOfService</td> <td>服务条款</td></tr> <tr><td>Contact.name</td> <td>联系名称</td></tr> <tr><td>Contact.url</td> <td>联系url</td></tr> <tr><td>Contact.email</td> <td>联系email</td></tr> <tr><td>License.name</td> <td>协议名称</td></tr> <tr><td>License.url</td> <td>协议地址</td></tr> <tr><td>Host</td> <td>服务host</td></tr> <tr><td>BasePath</td> <td>基础path</td></tr></tbody></table> <h6 id="文档"><a href="#文档" class="header-anchor">#</a> 文档</h6> <p><a href="https://swaggo.github.io/swaggo.io/declarative_comments_format/general_api_info.html" target="_blank" rel="noopener noreferrer">General API Info<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="api注释"><a href="#api注释" class="header-anchor">#</a> Api注释</h4> <h5 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h5> <div class="language-go extra-class"><pre class="language-go"><code>
<span class="token comment">// @Summary     登录</span>
<span class="token comment">// @Description 登录接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Param       data body     UserLoginRequest true &quot;登录凭证&quot;</span>
<span class="token comment">// @Response    200  {object} global.Response{data=UserLoginResponseData}</span>
<span class="token comment">// @Router      /api/user/login  [post]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Login</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> req UserLoginRequest
	<span class="token keyword">if</span> u<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token operator">&amp;</span>req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">Login</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     退出登录</span>
<span class="token comment">// @Description 退出登录接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @Response    200 {object} global.Response{}</span>
<span class="token comment">// @Router      /api/user/logout  [get]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Logout</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">Logout</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">GetUint64</span><span class="token punctuation">(</span><span class="token string">&quot;Id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     当前登录信息</span>
<span class="token comment">// @Description 获取登录信息接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @Response    200 {object} global.Response{data=UserCurrentResponseData}</span>
<span class="token comment">// @Router      /api/user/current  [get]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Current</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">Current</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">GetUint64</span><span class="token punctuation">(</span><span class="token string">&quot;Id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token function">GetBool</span><span class="token punctuation">(</span><span class="token string">&quot;RefreshAuthorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     修改密码</span>
<span class="token comment">// @Description 修改密码接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @Param       data body     ChangePasswordRequest true &quot;修改密码数据&quot;</span>
<span class="token comment">// @Response    200  {object} global.Response{data=global.UpdateResponseData}</span>
<span class="token comment">// @Router      /api/user/changePassword  [post]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">ChangePassword</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	req <span class="token operator">:=</span> <span class="token operator">&amp;</span>ChangePasswordRequest<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span> u<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		req<span class="token punctuation">.</span>Id <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">GetUint64</span><span class="token punctuation">(</span><span class="token string">&quot;Id&quot;</span><span class="token punctuation">)</span>
		u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">ChangePassword</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     用户信息</span>
<span class="token comment">// @Description 用户信息接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @param       id  query    uint64 true &quot;id&quot;</span>
<span class="token comment">// @Response    200 {object} global.Response{data=UserData}</span>
<span class="token comment">// @Router      /api/user  [get]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	u<span class="token punctuation">.</span>Controller<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token operator">&amp;</span>global<span class="token punctuation">.</span>GetRequest<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserData<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     用户列表</span>
<span class="token comment">// @Description 用户列表接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @param       account  query    string false &quot;账号&quot;</span>
<span class="token comment">// @param       username query    string false &quot;姓名&quot;</span>
<span class="token comment">// @param       role     query    string false &quot;角色&quot;</span>
<span class="token comment">// @param       status   query    int    false &quot;状态&quot;</span>
<span class="token comment">// @param       current  query    int    true  &quot;当前页数&quot;</span>
<span class="token comment">// @param       pageSize query    int    true  &quot;页数量&quot;</span>
<span class="token comment">// @Response    200      {object} global.Response{data=[]UserData}</span>
<span class="token comment">// @Router      /api/user/list  [get]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">List</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	req <span class="token operator">:=</span> <span class="token operator">&amp;</span>UserListRequest<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span> u<span class="token punctuation">.</span><span class="token function">ShouldBindQuery</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">List</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span>UserData<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     新增用户</span>
<span class="token comment">// @Description 新增用户接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @Param       data body     UserInsertRequest true &quot;新增用户信息&quot;</span>
<span class="token comment">// @Response    200  {object} global.Response{data=global.InsertResponseData}</span>
<span class="token comment">// @Router      /api/user  [post]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Insert</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	req <span class="token operator">:=</span> <span class="token operator">&amp;</span>UserInsertRequest<span class="token punctuation">{</span><span class="token punctuation">}</span>
	u<span class="token punctuation">.</span><span class="token function">CreatedBy</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
	<span class="token keyword">if</span> u<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> req<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     更新用户</span>
<span class="token comment">// @Description 更新用户接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @Param       data body     UserUpdateRequest true &quot;更新用户信息&quot;</span>
<span class="token comment">// @Response    200  {object} global.Response{data=global.UpdateResponseData}</span>
<span class="token comment">// @Router      /api/user  [put]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Update</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	u<span class="token punctuation">.</span>Controller<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserUpdateRequest<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// @Summary     删除用户</span>
<span class="token comment">// @Description 删除用户接口</span>
<span class="token comment">// @Tags        用户</span>
<span class="token comment">// @Accept      json</span>
<span class="token comment">// @Produce     json</span>
<span class="token comment">// @Security    Authorization</span>
<span class="token comment">// @Param       data body     global.RemovesRequest true &quot;删除用户id&quot;</span>
<span class="token comment">// @Response    200  {object} global.Response{data=global.RemoveResponseData}</span>
<span class="token comment">// @Router      /api/user  [delete]</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>UserController<span class="token punctuation">)</span> <span class="token function">Removes</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// request</span>
	req <span class="token operator">:=</span> <span class="token operator">&amp;</span>global<span class="token punctuation">.</span>RemovesRequest<span class="token punctuation">{</span><span class="token punctuation">}</span>
	u<span class="token punctuation">.</span><span class="token function">ShouldBindJSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
	<span class="token comment">// login id</span>
	loginId <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">GetUint64</span><span class="token punctuation">(</span><span class="token string">&quot;Id&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> id <span class="token operator">:=</span> <span class="token keyword">range</span> req<span class="token punctuation">.</span>Ids <span class="token punctuation">{</span>
		<span class="token keyword">if</span> id <span class="token operator">==</span> loginId <span class="token punctuation">{</span>
			u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> Err_User_Can_Not_Remove_self_Response<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> id <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
			u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> Err_User_Can_Not_Remove_Super_Response<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// remove login flag</span>
		u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">DelLoginStatus</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	u<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> u<span class="token punctuation">.</span>Svc<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="说明-2"><a href="#说明-2" class="header-anchor">#</a> 说明</h5> <table><thead><tr><th>注释</th> <th>说明</th></tr></thead> <tbody><tr><td>Description</td> <td>Api行为的详细说明</td></tr> <tr><td>Id</td> <td>用于标识操作的唯一字符串。在所有API操作中必须是唯一的</td></tr> <tr><td>Tags</td> <td>每个API操作的标签列表，用逗号分隔。</td></tr> <tr><td>Summary</td> <td>Api的简短摘要</td></tr> <tr><td>Accept</td> <td>api可以使用的MIME类型列表。值必须与Mime类型下的描述一致</td></tr> <tr><td>Produce</td> <td>api可以生成的MIME类型列表。值必须与Mime类型下的描述一致</td></tr> <tr><td>Param</td> <td>用空格分隔的参数 param name,param type,data type,is mandatory?,comment attribute(optional)</td></tr> <tr><td>Security</td> <td>每个API操作的安全性</td></tr> <tr><td>Success</td> <td>用空格分隔的成功响应. return code,{param type},data type,comment</td></tr> <tr><td>Failure</td> <td>用空格分隔的故障响应. return code,{param type},data type,comment</td></tr> <tr><td>Response</td> <td>用空格分隔的响应. return code,{param type},data type,comment</td></tr> <tr><td>Router</td> <td>路由. path,[httpMethod]</td></tr></tbody></table> <h6 id="文档-2"><a href="#文档-2" class="header-anchor">#</a> 文档</h6> <p><a href="https://swaggo.github.io/swaggo.io/declarative_comments_format/api_operation.html" target="_blank" rel="noopener noreferrer">API Operation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="生成文档"><a href="#生成文档" class="header-anchor">#</a> 生成文档</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 格式化swag注释</span>
➜  gin-framework-layout git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> swag <span class="token function">fmt</span>                                   
➜  gin-framework-layout git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> 
<span class="token comment"># 生成swag文档</span>
<span class="token comment">## --parseDependency, --pd 在依赖文件夹内解析go文件，默认禁用(默认值:false)</span>
<span class="token comment">## --parseInternal 在内部包中解析go文件，默认禁用(默认值:false)</span>
➜  gin-framework-layout git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> swag init <span class="token parameter variable">--parseDependency</span> <span class="token parameter variable">--parseInternal</span>      
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:57 Generate swagger docs<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:57 Generate general API Info, search dir:./
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.UserLoginRequest
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.Response
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.UserLoginResponseData
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.UserCurrentResponseData
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.ChangePasswordRequest
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.UpdateResponseData
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.UserData
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.Data
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.CreatedBy
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.UpdatedBy
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.UserInsertRequest
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.InsertResponseData
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating user.UserUpdateRequest
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.RemovesRequest
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 Generating global.RemoveResponseData
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 create docs.go at  docs/docs.go
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 create swagger.json at  docs/swagger.json
<span class="token number">2022</span>/11/03 <span class="token number">16</span>:35:59 create swagger.yaml at  docs/swagger.yaml
<span class="token comment"># 文档路径</span>
➜  gin-framework-layout git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> <span class="token builtin class-name">cd</span> docs 
➜  docs git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> tree
<span class="token builtin class-name">.</span>
├── docs.go
├── swagger.json
└── swagger.yaml

<span class="token number">0</span> directories, <span class="token number">3</span> files
</code></pre></div><h2 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h2> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> router

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;net/http&quot;</span>

	<span class="token string">&quot;github.com/goweb/gin-framework-core/global&quot;</span>
	<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>

	swaggerFiles <span class="token string">&quot;github.com/swaggo/files&quot;</span>
	ginSwagger <span class="token string">&quot;github.com/swaggo/gin-swagger&quot;</span>

    <span class="token boolean">_</span> <span class="token string">&quot;github.com/goweb/gin-framework-layout/docs&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">RegisterHealthyCheckRouter</span><span class="token punctuation">(</span>g <span class="token operator">*</span>gin<span class="token punctuation">.</span>Engine<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// ping router</span>
	g<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/healthyCheck&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
			<span class="token string">&quot;msg&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">RegisterSwaggerRouter</span><span class="token punctuation">(</span>g <span class="token operator">*</span>gin<span class="token punctuation">.</span>Engine<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// debug mode run swagger server</span>
	<span class="token keyword">if</span> global<span class="token punctuation">.</span>Config<span class="token punctuation">.</span>Sys<span class="token punctuation">.</span>Mode <span class="token operator">==</span> gin<span class="token punctuation">.</span>DebugMode <span class="token operator">||</span> global<span class="token punctuation">.</span>Config<span class="token punctuation">.</span>Sys<span class="token punctuation">.</span>Mode <span class="token operator">==</span> gin<span class="token punctuation">.</span>TestMode <span class="token punctuation">{</span>
		<span class="token comment">// swagger router</span>
		g<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/swagger/*any&quot;</span><span class="token punctuation">,</span> ginSwagger<span class="token punctuation">.</span><span class="token function">WrapHandler</span><span class="token punctuation">(</span>swaggerFiles<span class="token punctuation">.</span>Handler<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># go mod tidy下载相关依赖包</span>
➜  gin-framework-layout git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> go mod tidy
</code></pre></div><h2 id="访问"><a href="#访问" class="header-anchor">#</a> 访问</h2> <p><a href="http://localhost:8888/swagger/index.html" target="_blank" rel="noopener noreferrer">swagger地址:http://localhost:8888/swagger/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#安装" title="安装">安装</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#注释" title="注释">注释</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#生成文档" title="生成文档">生成文档</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#路由" title="路由">路由</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#访问" title="访问">访问</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/fbbyqsyea" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8>MIT Licensed | Copyright © 2024-fbbyqsyea</li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.99f1e4ad.js" defer></script><script src="/assets/js/6.38d57c41.js" defer></script><script src="/assets/js/3.122d5fd9.js" defer></script><script src="/assets/js/28.7ec74a54.js" defer></script>
  </body>
</html>
