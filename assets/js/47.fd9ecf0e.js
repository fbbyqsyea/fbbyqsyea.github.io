(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{354:function(a,t,s){"use strict";s.r(t);var e=s(5),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"三步生成研测https证书"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三步生成研测https证书"}},[a._v("#")]),a._v(" 三步生成研测https证书")]),a._v(" "),t("h2",{attrs:{id:"问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),t("p",[a._v("今天在研测环境中配置nginx代理一个http服务，在纠结要不要配置https("),t("em",[a._v("因为每次配置https都感觉挺麻烦")]),a._v(")，突然发现可以借助chatgpt偷个懒，所以就有了这篇chatgpt生产的文章😁。今天的问题是如何快速让研测环境支持https？")]),a._v(" "),t("h2",{attrs:{id:"解答"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解答"}},[a._v("#")]),a._v(" 解答")]),a._v(" "),t("h4",{attrs:{id:"前提条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前提条件"}},[a._v("#")]),a._v(" 前提条件")]),a._v(" "),t("p",[a._v("需要服务器先安装OpenSSL。以ubuntu为例:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" update\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" openssl\n")])])]),t("h4",{attrs:{id:"生成步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成步骤"}},[a._v("#")]),a._v(" 生成步骤")]),a._v(" "),t("h6",{attrs:{id:"生成私钥-key-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成私钥-key-文件"}},[a._v("#")]),a._v(" 生成私钥（key）文件")]),a._v(" "),t("p",[a._v("运行以下命令生成私钥文件：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ openssl genrsa "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-out")]),a._v(" private.key "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2048")]),a._v("\n")])])]),t("p",[a._v("这将生成一个 2048 位的 RSA 私钥，并将其保存为 private.key 文件。")]),a._v(" "),t("h6",{attrs:{id:"生成证书签名请求-csr-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成证书签名请求-csr-文件"}},[a._v("#")]),a._v(" 生成证书签名请求（CSR）文件")]),a._v(" "),t("p",[a._v("运行以下命令生成 CSR 文件，其中 "),t("strong",[a._v("your-domain")]),a._v(" 是您的域名")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ openssl req "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-key")]),a._v(" private.key "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-out")]),a._v(" csr.pem "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-subj")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/CN=<your-domain>"')]),a._v("\n")])])]),t("p",[a._v("这将生成一个包含您的域名信息的 CSR 文件，并将其保存为 csr.pem 文件。")]),a._v(" "),t("h6",{attrs:{id:"自签名证书-可选"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自签名证书-可选"}},[a._v("#")]),a._v(" 自签名证书（可选）")]),a._v(" "),t("p",[a._v("如果您只是在测试环境中使用证书，或者只需要自签名证书，您可以生成自签名证书：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ openssl x509 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-req")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-in")]),a._v(" csr.pem "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-signkey")]),a._v(" private.key "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-out")]),a._v(" certificate.crt "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-days")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("365")]),a._v("\n")])])]),t("p",[a._v("这将使用 CSR 文件和私钥文件生成一个有效期为 365 天的自签名证书，并将其保存为 certificate.crt 文件。")]),a._v(" "),t("h4",{attrs:{id:"配置到nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置到nginx"}},[a._v("#")]),a._v(" 配置到nginx")]),a._v(" "),t("div",{staticClass:"language-nginx extra-class"},[t("pre",{pre:!0,attrs:{class:"language-nginx"}},[t("code",[t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("server")])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("listen")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("443")]),a._v(" ssl")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("server_name")]),a._v(" example.com")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ssl_certificate")]),a._v(" /etc/nginx/certificates/certificate.crt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token directive"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ssl_certificate_key")]),a._v(" /etc/nginx/certificates/private.key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 其他的 Nginx 配置指令")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);